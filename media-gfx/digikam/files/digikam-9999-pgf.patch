diff -Naur digikam-9999/cmake/modules/FindPGF.cmake digikam-9999-fixed/cmake/modules/FindPGF.cmake
--- digikam-9999/cmake/modules/FindPGF.cmake	1970-01-01 07:00:00.000000000 +0700
+++ digikam-9999-fixed/cmake/modules/FindPGF.cmake	2010-08-25 01:03:32.000000000 +0700
@@ -0,0 +1,15 @@
+# - Try to find libpgf
+# Once done this will define
+#
+#  PGF_FOUND - system has libgf
+#  PGF_INCLUDE_DIRS - the libpgf include directory
+#  PGF_LIBRARIES - Link these to use libpgf
+
+# PKG-CONFIG is required.
+INCLUDE(FindPkgConfig REQUIRED)
+
+IF(PKG_CONFIG_FOUND)
+       INCLUDE(FindPkgConfig)
+
+       PKG_CHECK_MODULES(PGF libpgf)
+ENDIF(PKG_CONFIG_FOUND)
diff -Naur digikam-9999/CMakeLists.txt digikam-9999-fixed/CMakeLists.txt
--- digikam-9999/CMakeLists.txt	2010-08-25 01:00:50.000000000 +0700
+++ digikam-9999-fixed/CMakeLists.txt	2010-08-25 01:04:10.000000000 +0700
@@ -34,6 +34,9 @@
     "${DIGIKAM_VERSION_SHORT}${DIGIKAM_SUFFIX_VERSION}"
    )
 
+# Path to find FindPGF.cmake script.
+SET(CMAKE_MODULE_PATH ${CMAKE_MODULE_PATH} "${CMAKE_SOURCE_DIR}/cmake/modules")
+
 # ==================================================================================================
 # Debug area codes
 # These codes will be set for every project specific path automatically, so
@@ -133,6 +136,11 @@
 FIND_PACKAGE(JPEG)
 FIND_PACKAGE(PNG)
 FIND_PACKAGE(TIFF)
+
+# Included to unbundle libpgf that is on portage tree.
+# This function call the script cmake/modules/FindPGF.cmake
+FIND_PACKAGE(PGF)
+
 FIND_PACKAGE(Jasper)
 FIND_PACKAGE(Kdcraw)
 FIND_PACKAGE(Kexiv2)
@@ -263,6 +271,7 @@
     PRINT_EXECUTABLE_STATUS("MySQL install_db tool" mysql_install_db MYSQL_TOOLS_PATH INITCMD_MYSQL)
 ENDIF (NOT WIN32)
 PRINT_LIBRARY_STATUS("libtiff" "http://www.remotesensing.org/libtiff" "" TIFF_FOUND)
+PRINT_LIBRARY_STATUS("libpgf" "http://www.libpgf.org" "" PGF_FOUND)
 PRINT_LIBRARY_STATUS("libpng" "http://www.libpng.org/pub/png/libpng.html" " (version >= 1.2.7)" PNG_FOUND)
 PRINT_LIBRARY_STATUS("libjasper" "http://www.ece.uvic.ca/~mdadams/jasper" "" JASPER_FOUND)
 PRINT_LIBRARY_STATUS("liblcms" "http://www.littlecms.com" "" LCMS_FOUND)
@@ -365,13 +374,13 @@
 
 ENDIF(DOXYGEN_FOUND)
 
-IF(LCMS_FOUND AND JPEG_FOUND AND PNG_FOUND AND TIFF_FOUND AND JASPER_FOUND AND KDCRAW_FOR_DIGIKAM AND KEXIV2_FOR_DIGIKAM AND KIPI_FOUND)
+IF(LCMS_FOUND AND JPEG_FOUND AND PNG_FOUND AND TIFF_FOUND AND PGF_FOUND AND JASPER_FOUND AND KDCRAW_FOR_DIGIKAM AND KEXIV2_FOR_DIGIKAM AND KIPI_FOUND)
     MESSAGE(STATUS " digiKam will be compiled................. YES")
     SET(DIGIKAM_CAN_BE_COMPILED true)
-ELSE(LCMS_FOUND AND JPEG_FOUND AND PNG_FOUND AND TIFF_FOUND AND AND JASPER_FOUND AND KDCRAW_FOR_DIGIKAM AND KEXIV2_FOR_DIGIKAM AND KIPI_FOUND)
+ELSE(LCMS_FOUND AND JPEG_FOUND AND PNG_FOUND AND TIFF_FOUND AND PGF_FOUND AND JASPER_FOUND AND KDCRAW_FOR_DIGIKAM AND KEXIV2_FOR_DIGIKAM AND KIPI_FOUND)
     MESSAGE(FATAL_ERROR " digiKam will be compiled................. NO  (Look README file for more details about dependencies)")
     SET(DIGIKAM_CAN_BE_COMPILED false)
-ENDIF(LCMS_FOUND AND JPEG_FOUND AND PNG_FOUND AND TIFF_FOUND AND JASPER_FOUND AND KDCRAW_FOR_DIGIKAM AND KEXIV2_FOR_DIGIKAM AND KIPI_FOUND)
+ENDIF(LCMS_FOUND AND JPEG_FOUND AND PNG_FOUND AND TIFF_FOUND AND PGF_FOUND AND JASPER_FOUND AND KDCRAW_FOR_DIGIKAM AND KEXIV2_FOR_DIGIKAM AND KIPI_FOUND)
 
 MESSAGE(STATUS "----------------------------------------------------------------------------------")
 MESSAGE(STATUS "")
@@ -1023,14 +1032,7 @@
         ${CMAKE_CURRENT_SOURCE_DIR}/libs/threadimageio/pgfutils.cpp
        )
 
-    SET(libpgf_SRCS
-        ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/libpgf/Decoder.cpp
-        ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/libpgf/Encoder.cpp
-        ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/libpgf/PGFimage.cpp
-        ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/libpgf/Stream.cpp
-        ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/libpgf/Subband.cpp
-        ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/libpgf/WaveletTransform.cpp
-       )
+    INCLUDE_DIRECTORIES(${PGF_INCLUDE_DIRS})
 
     SET(libsqlite2_SRCS
         ${CMAKE_CURRENT_SOURCE_DIR}/libs/3rdparty/sqlite2/attach.c
@@ -1340,16 +1342,39 @@
 # ==================================================================================================
 # API documentation generation
 
-IF(DOXYGEN_FOUND)
+# Checks if user ask to build documentation.
+IF(BUILD_DOC)
+    IF(DOXYGEN_FOUND)
+
+        MESSAGE(STATUS "")
+        MESSAGE(STATUS "Documentation will be installed")
+       MESSAGE(STATUS "")
 
     SET(API_DIR ${CMAKE_BINARY_DIR}/api)
     SET(SOURCE_DIR ${CMAKE_SOURCE_DIR})
     SET(DOXYFILE ${CMAKE_BINARY_DIR}/Doxyfile)
     SET(WARNFILE ${CMAKE_BINARY_DIR}/doxygen-warn.log)
 
+
     CONFIGURE_FILE(Doxyfile.cmake ${DOXYFILE})
 
     ADD_CUSTOM_TARGET(doc ${DOXYGEN_EXECUTABLE} ${DOXYFILE}
                       WORKING_DIRECTORY ${CMAKE_BINARY_DIR})
 
-ENDIF(DOXYGEN_FOUND)
+    ELSE(DOXYGEN_FOUND)
+
+        MESSAGE(STATUS "")
+        MESSAGE(STATUS "Documentation will NOT be installed")
+       MESSAGE(STATUS "Doxygen wasn't found on the system")
+       MESSAGE(STATUS "")
+
+    ENDIF(DOXYGEN_FOUND)
+
+ELSE(BUILD_DOC)
+
+    MESSAGE(STATUS "")
+    MESSAGE(STATUS "Documentation will NOT be installed")
+    MESSAGE(STATUS "Because the option -DBUILD_DOC=ON wasn't passed to cmake")
+    MESSAGE(STATUS "")
+
+ENDIF(BUILD_DOC)
diff -Naur digikam-9999/digikam/CMakeLists.txt digikam-9999-fixed/digikam/CMakeLists.txt
--- digikam-9999/digikam/CMakeLists.txt	2010-08-25 01:00:51.000000000 +0700
+++ digikam-9999-fixed/digikam/CMakeLists.txt	2010-08-25 00:58:52.000000000 +0700
@@ -53,7 +53,6 @@
                      # specific libs and utilities
                      ${CMAKE_CURRENT_SOURCE_DIR}/../libs/3rdparty/lprof
                      ${CMAKE_CURRENT_SOURCE_DIR}/../libs/3rdparty/sqlite2
-                     ${CMAKE_CURRENT_SOURCE_DIR}/../libs/3rdparty/libpgf
                      ${CMAKE_CURRENT_SOURCE_DIR}/../libs/3rdparty/clapack
                      ${CMAKE_CURRENT_SOURCE_DIR}/../libs/3rdparty/cimg
                      ${CMAKE_CURRENT_SOURCE_DIR}/../libs/themeengine
@@ -92,6 +91,7 @@
                      ${JPEG_INCLUDE_DIR}
                      ${PNG_PNG_INCLUDE_DIR}
                      ${TIFF_INCLUDE_DIR}
+                     ${PGF_INCLUDE_DIRS}
                    )
 
 IF(LENSFUN_LIBRARY)
@@ -103,9 +103,6 @@
 # Disable Clapack C code warnings.
 SET_SOURCE_FILES_PROPERTIES(${libclapack_SRCS} PROPERTIES COMPILE_FLAGS "-w")
 
-# Disable libpgf warnings.
-SET_SOURCE_FILES_PROPERTIES(${libpgf_SRCS} PROPERTIES COMPILE_FLAGS "-w")
-
 # Disable liblqr C code warnings.
 SET_SOURCE_FILES_PROPERTIES(${liblqr_SRCS} PROPERTIES COMPILE_FLAGS "-w")
 
@@ -124,7 +121,6 @@
                         ${libjpegutils_SRCS}
                         ${libthreadimageio_SRCS}
                         ${libthemeengine_SRCS}
-                        ${libpgf_SRCS}
                         ${pgfutils_SRCS}
                         ${libdigikamhelpers_SRCS}
                         ${libtthread_SRCS}
@@ -177,6 +173,7 @@
                       ${JPEG_LIBRARIES}
                       ${TIFF_LIBRARIES}
                       ${PNG_LIBRARIES}
+                      ${PGF_LIBRARIES}
                       ${LCMS_LIBRARIES}
                       ${JASPER_LIBRARIES}
 
@@ -229,7 +226,6 @@
                              ${libhaar_SRCS}
                              ${libdatabasemodels_SRCS}
                              ${libsqlite2_SRCS}
-                             ${libpgf_SRCS}
                              ${pgfutils_SRCS}
    )
 
@@ -244,6 +240,7 @@
                       ${QT_QTCORE_LIBRARY}
                       ${QT_QTGUI_LIBRARY}
                       ${QT_QTSQL_LIBRARY}
+                      ${PGF_LIBRARIES}
                      )
 
 SET_TARGET_PROPERTIES(digikamdatabase PROPERTIES VERSION 1.0.0 SOVERSION 1 )
diff -Naur digikam-9999/libs/CMakeLists.txt digikam-9999-fixed/libs/CMakeLists.txt
--- digikam-9999/libs/CMakeLists.txt	2010-08-25 01:00:53.000000000 +0700
+++ digikam-9999-fixed/libs/CMakeLists.txt	2010-08-25 00:59:25.000000000 +0700
@@ -18,6 +18,7 @@
                      ${JPEG_INCLUDE_DIR}
                      ${TIFF_INCLUDE_DIR}
                      ${PNG_INCLUDE_DIR}
+                     ${PGF_INCLUDE_DIRS}
                      ${JASPER_INCLUDE_DIR}
                    )
 